{% extends "layout.html" %}

{% block content %}
  <div id="map"></div>
  <script src="{{ url_for('static', filename='js/universal.js') }}"/></script>
  <script>

    var info = L.control();

    <!--plot marker on center of the city-->
    {% for marker in markers %}
      var markerCenter = L.marker([{{ marker['lat'] }}, {{ marker['lon'] }}]).addTo(map)
      markerCenter.bindPopup("{{ marker['popup'] }}").openPopup();
    {% endfor %}

    <!--bus stops using df from stops gtfs format-->
    {% for bus_stop_all in bus_stops_all_markers %}
      var markerBusStops = L.marker([{{ bus_stop_all['stop_lat'] }}, {{ bus_stop_all['stop_lon'] }}]).addTo(map)
      markerBusStops.bindPopup("{{ bus_stop_all['stop_name'].split(",")[1:] }}").openPopup();

      <!--return coordinates of marker when clicked-->
      markerBusStops.on('click', function (e) {
      var markerlatlng = e.target.getLatLng();
      console.log(markerlatlng);

      // Create variables dor later use in the html

      // return name of the bus stop
      var name = this.getPopup().getContent();

      if (document.getElementById("name-stop") != null){
        document.getElementById("name-stop").innerHTML = name;
      }

      // return latitude and longitude of the bus stop
      var lat =  markerlatlng.lat
      var long = markerlatlng.lng

      if (document.getElementById("lat-stop") != null){
        document.getElementById("lat-stop").innerHTML = lat;
      }
      if (document.getElementById("long-stop") != null){
        document.getElementById("long-stop").innerHTML = long;
      }


      if (document.getElementById("marker-info") != null){
        document.getElementById("marker-info").innerHTML = markerlatlng;
      }



      console.log(markerlatlng_html)

      });


    {% endfor %}

  </script>

  <html>
    <div class="component">
      <div class="box">
        <h4>Bus Stop:</h4>
        <p id="name-stop"></p>
      </div>

      <div class="box">
        <h4>Latitude:</h4>
        <p id="lat-stop"></p>
      </div>

      <div class="box">
        <h4>Longitude:</h4>
        <p id="long-stop"></p>
      </div>

      <div class="box">
        Box 4
      </div>

      <div class="box">
        Box 5
      </div>
    </div>
  </html>

{% endblock content %}






